import{colors,updateEntities,processCtx,drawEntities,getCanvas,random}from"./js/utils.js";import{Car}from"./js/car.js";import{Road}from"./js/road.js";import{trafficData}from"./js/traffic.js";import{Visualizer}from"./js/visualizer.js";var request;const{gameCanvas,gameCtx,networkCanvas,networkCtx,factory}=getCanvas(200),road=factory.create(Road,{x:gameCanvas.width/2,width:.9*gameCanvas.width}),traffic=(window.car=factory.create(Car,{x:road.getLaneCenter(1),y:100,model:"sedan",control:"AI",color:colors[2]}),trafficData(road).map(({x,y})=>factory.create(Car,{x:x,y:y,model:"sedan",color:colors[Math.floor(random(5,colors.length))]}))),animate=()=>{updateEntities({road:road,car:car,traffic:traffic}),processCtx({gameCanvas:gameCanvas,gameCtx:gameCtx,networkCanvas:networkCanvas,networkCtx:networkCtx,car:car}),drawEntities(gameCtx,[road,traffic,car]),gameCtx.restore(),Visualizer.drawNetwork(networkCtx,car.brain),request=requestAnimationFrame(animate)};request=requestAnimationFrame(animate);